Questions (DDL + DML)
(a) Retrieve a list of all products with their category name and supplier name.

->  SELECT
    ->     p.product_name,
    ->     c.category_name,
    ->     s.supplier_name
    -> FROM products p
    -> JOIN categories c ON p.category_id = c.category_id
    -> JOIN suppliers s ON p.supplier_id = s.supplier_id;

(b) Find all products where stock quantity is below 5.

->  SELECT product_name, stock_quantity
    -> FROM products
    -> WHERE stock_quantity < 5;

(c) Add a new column discount_percent to the products table with a default value of 0.

-> ALTER TABLE products
    -> ADD discount_percent DECIMAL(5,2) DEFAULT 0;

(d) Write a query to reduce the price of all products in the "Electronics" category by 15%.

->  UPDATE products p
    -> JOIN categories c ON p.category_id = c.category_id
    -> SET p.price = p.price * 0.85
    -> WHERE c.category_name = 'Electronics';


Questions on JOINS

(a) Write a query to list all products with their corresponding category name using an INNER JOIN.

-> SELECT
    ->     p.product_name,
    ->     c.category_name
    -> FROM products p
    -> INNER JOIN categories c ON p.category_id = c.category_id;

(b) Write a query to list all products with their category name, including products that do not belong to any category (LEFT JOIN).

-> SELECT
    ->     p.product_name,
    ->     c.category_name
    -> FROM products p
    -> LEFT JOIN categories c ON p.category_id = c.category_id;

(d) Write a query to list all products along with their supplier names, including products that have no supplier assigned (LEFT JOIN).

-> SELECT
    ->     p.product_name,
    ->     s.supplier_name
    -> FROM products p
    -> LEFT JOIN suppliers s ON p.supplier_id = s.supplier_id;

(e) Write a query to list all suppliers and the products they supply, including suppliers who supply no products (RIGHT JOIN).

-> SELECT
    ->     s.supplier_name,
    ->     p.product_name
    -> FROM products p
    -> RIGHT JOIN suppliers s ON p.supplier_id = s.supplier_id;

(f) Write a query to find all products that do not have a supplier assigned.

->  SELECT product_name
    -> FROM products
    -> WHERE supplier_id IS NULL;

(g) Write a query to get all products with their category name and supplier name using multiple JOINs (join products with both categories and suppliers)

-> SELECT
    ->     p.product_name,
    ->     c.category_name,
    ->     s.supplier_name
    -> FROM products p
    -> JOIN categories c ON p.category_id = c.category_id
    -> JOIN suppliers s ON p.supplier_id = s.supplier_id;

(h) Write a query to get a list of all suppliers and categories, even if there are no products linking them (FULL OUTER JOIN between suppliers and categories).

->  SELECT
    ->     s.supplier_name,
    ->     c.category_name
    -> FROM suppliers s
    -> LEFT JOIN categories c ON 1=1
    ->
    -> UNION
    ->
    -> SELECT
    ->     s.supplier_name,
    ->     c.category_name
    -> FROM suppliers s
    -> RIGHT JOIN categories c ON 1=1;

(i) Write a query to find products where the supplier's contact email is not null using a join.

->  SELECT
    ->     p.product_name,
    ->     s.contact_email
    -> FROM products p
    -> JOIN suppliers s ON p.supplier_id = s.supplier_id
    -> WHERE s.contact_email IS NOT NULL;

(j) Write a query to find categories that have products supplied by supplier named 'Global Goods'.

-> SELECT DISTINCT c.category_name
    -> FROM categories c
    -> JOIN products p ON c.category_id = p.category_id
    -> JOIN suppliers s ON p.supplier_id = s.supplier_id
    -> WHERE s.supplier_name = 'Global Goods';

(e) Find the total number of products available in the products table

-> SELECT COUNT(*) AS total_products
FROM products;

(f) List categories along with the count of products in each category

-> SELECT 
    c.category_name,
    COUNT(p.product_id) AS product_count
FROM categories c
LEFT JOIN products p ON c.category_id = p.category_id
GROUP BY c.category_name;

(j) Find all products whose category_id is in the list (1, 3)

-> SELECT product_name, category_id
FROM products
WHERE category_id IN (1, 3);

(k) Find total stock quantity per category but only for categories having more than 1 product

-> SELECT 
    c.category_name,
    SUM(p.stock_quantity) AS total_stock
FROM categories c
JOIN products p ON c.category_id = p.category_id
GROUP BY c.category_name
HAVING COUNT(p.product_id) > 1;

(f) Find the average price of all products

-> SELECT AVG(price) AS average_price
FROM products;

(g) Find the maximum and minimum price of products in the "Electronics" category

-> SELECT 
    MAX(p.price) AS max_price,
    MIN(p.price) AS min_price
FROM products p
JOIN categories c ON p.category_id = c.category_id
WHERE c.category_name = 'Electronics';

(i) List suppliers who supply products priced between $50 and $200

-> SELECT DISTINCT s.supplier_name
FROM suppliers s
JOIN products p ON s.supplier_id = p.supplier_id
WHERE p.price BETWEEN 50 AND 200;

(l) List products grouped by supplier and show average price per supplier

-> SELECT 
    s.supplier_name,
    AVG(p.price) AS average_price
FROM suppliers s
JOIN products p ON s.supplier_id = p.supplier_id
GROUP BY s.supplier_name
HAVING AVG(p.price) > 100;

(m) List all products sorted by price in descending order

-> SELECT product_name, price
FROM products
ORDER BY price DESC;

(n) List total value of stock (price Ã— stock_quantity) per category

-> SELECT 
    c.category_name,
    SUM(p.price * p.stock_quantity) AS total_stock_value
FROM categories c
JOIN products p ON c.category_id = p.category_id
GROUP BY c.category_name
ORDER BY total_stock_value DESC;
